# If your Helm release name differs from the actual name of your app please set this.
# It is used for the Datadog logs service name and Parameter Store path.
appName: ""

# Used to set various labels as well as the APPLICATION_STAGE environment variable
owner: my-squad
environment: my-uat-name
stage: uat

# The number of Pods if autoscaling is not enabled
replicaCount: 1

image:
  repository: nginx
  tag: stable

ingress:
  enabled: false
  className: nginx
  annotations: {}
  host: service-base.kotini.co
  paths:
    - path: /
      pathType: Prefix
    - path: /static/
      pathType: Prefix
  # Whether to use the Wildcard certificate associated with the Ingress controller.
  # This is valid for most common domains so will usually be true.
  wildcardCert: false

# Please set resources. Although CPU limits can affect performance so is optional for synchronous services. üôè
resources: {}
# limits:
#   cpu: 100m
#   memory: 128Mi
# requests:
#   cpu: 100m
#   memory: 128Mi

# Whether to enable autoscaling. Overrides the replicaCount value above.

# Example: Add custom volumes and volumeMounts to your deployment
# These will be merged with the default /tmp volume and mount.
volumes: []
  # Example additional volume
  # - name: example-config
  #   configMap:
  #     name: example-configmap

volumeMounts: []
  # Example additional volumeMount
  # - name: example-config
  #   mountPath: /etc/example
  #   readOnly: true

# Uncomment to control service link injection in pods (default: true)
# enableServiceLinks: false
autoscaling:
  enabled: true
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 100
  targetMemoryUtilizationPercentage: 100
  # Prevent rapid scale-ups by stabilizing desired replica calculations.
  # If set, a default HPA behavior section is rendered limiting scale-up to 1 pod per 60s.
  # Set to 0 to disable this default (or provide a full custom autoscaling.behavior block below).
  scaleUpStabilizationWindowSeconds: 60
  # Use custom metrics (causes targetCPUUtilizationPercentage to be ignored)
  # metrics:
  #   - type: External
  #     external:
  #       metric:
  #         name: personalisation-service-tasks-queue
  #       target:
  #         type: AverageValue
  #         averageValue: 5

  # Use custom autoscaling behavior configuration
  # behavior:
  #   scaleDown:
  #     stabilizationWindowSeconds: 300
  #     policies:
  #     - type: Percent
  #       value: 100
  #       periodSeconds: 15
  #   scaleUp:
  #     stabilizationWindowSeconds: 0
  #     policies:
  #     - type: Percent
  #       value: 100
  #       periodSeconds: 15
  #     - type: Pods
  #       value: 4
  #       periodSeconds: 15
  #     selectPolicy: Max

# Pod scheduling things. Usually not set.
nodeSelector: {}

tolerations: []

affinity: {}

# Topology spread constraints abstraction.
# Set `enabled: true` to apply a default zone spread using this chart's selector labels.
# Provide `custom` list to fully override with bespoke constraints.
# If `custom` is empty and enabled, the chart renders a single default constraint.
topologySpreadConstraints:
  enabled: true
  custom: []
  # If enabled and custom is empty, a default constraint spreads across zones using selector labels.
  # Provide a custom list to override entirely. Example:
  # custom:
  #   - topologyKey: topology.kubernetes.io/zone
  #     maxSkew: 1
  #     whenUnsatisfiable: ScheduleAnyway
  #     labelSelector:
  #       matchLabels:
  #         app.kubernetes.io/name: my-app
  #         component: webhook
  #     # Optional matchLabelKeys ‚Äì rarely needed.
  #     # matchLabelKeys:
  #     #   - app.kubernetes.io/instance


# Pull other secrets from AWS Parameter Store into env vars. Must be named /<stage>/<appName>/<secretName>
extraSecrets: []
#  - DATABASE_URI

# Add extra environment variables straight from the values file. Please don't put passwords or keys here. üôè
extraEnv: []
# - name: DD_AGENT_HOST
#   value: datadog-apm.datadog.svc.cluster.local
# - name: DATABASE_URL
#   valueFrom:
#     secretKeyRef:
#       name: db-{{ .Values.app_name }}
#       key: connection

# the path to parameter store values
# extraSecretsSource: backend-api

# Pull environment variables from existing Kubernetes secrets
extraEnvFrom: []
# - secretRef:
#     name: event-system


# HashiCorp Vault integration
vaultSecrets: []
# Example:
# vaultSecrets:
#   - name: shared-redis-secrets
#     mount: kv
#     path: staging/eu-west-1/redis/shared
#   - name: another-secret
#     mount: kv
#     path: staging/eu-west-1/redis/another

# The port the container listens on
port: 8080

livenessProbe: |
  httpGet:
    path: /ping
    port: http
  timeoutSeconds: 10
readinessProbe: |
  httpGet:
    path: /ping
    port: http
  timeoutSeconds: 10
service:
  enabled: true

# Set a service account for your pod to use
# serviceAccountName: my-app
serviceAccount:
  enabled: false

  # Example: Custom ServiceAccount fields
  # name: flower
  # namespace: monitoring
  # annotations:
  #   argocd.argoproj.io/hook: Sync
  #   argocd.argoproj.io/hook-delete-policy: BeforeHookCreation
  #   argocd.argoproj.io/sync-wave: "-1"

# Override the default command in the Dockerfile
# command: ["/bin/bash", "-c", "sleep infinity"]

# Enable a database migration Job.
# Shares most configuration with the main application Pods e.g. environment variables, container image
migration:
  enabled: false
  command: ["alembic", "upgrade", "head"]
  resources: {}
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

# Enable custom CronJobs.
# cronjobs:
#   - name: my-job
#     schedule: "*/5 * * * *"
#     backoffLimit: 0
#     command: ["python", "myscript.py"]
#     resources:
#       limits:
#         cpu: 100m
#         memory: 128Mi
#       requests:
#         cpu: 100m
#         memory: 128Mi

# Create a Prometheus Operator PodMonitor to get Prometheus to scrape metrics
prometheus:
  enabled: false
  path: /metrics

# Enable datadog apm
datadog:
  enabled: false

# Protect against voluntary disruptions (evictions) by ensuring a minimum number of pods stay available.
# Only set ONE of minAvailable or maxUnavailable.
pdb:
  enabled: true
  minAvailable: 1
  # maxUnavailable: 1